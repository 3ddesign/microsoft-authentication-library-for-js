/*! @azure/msal-common v1.0.0-beta.3 2020-07-02 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msalCommon={})}(this,function(l){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function e(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function p(i,c,a,s){return new(a=a||Promise)(function(e,t){function r(e){try{o(s.next(e))}catch(e){t(e)}}function n(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}o((s=s.apply(i,c||[])).next())})}function f(r,n){var o,i,c,e,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(c=2&t[0]?i.return:t[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,t[1])).done)return c;switch(i=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(c=0<(c=a.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){a.label=t[1];break}if(6===t[0]&&a.label<c[1]){a.label=c[1],c=t;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(t);break}c[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],i=0}finally{o=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function o(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],c=0,a=i.length;c<a;c++,o++)n[o]=i[c];return n}var i,t={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},r=(e(c,i=Error),c.createUnexpectedError=function(e){return new c(t.unexpectedError.code,t.unexpectedError.desc+": "+e)},c);function c(e,t){var r=this,n=t?e+": "+t:e;return r=i.call(this,n)||this,Object.setPrototypeOf(r,c.prototype),r.errorCode=e,r.errorMessage=t,r.name="AuthError",r}var a,s="1.0.0-beta.3",d=s,u={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},idTokenParsingError:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},accountMismatchError:{code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},cacheParseError:{code:"cache_parse_error",desc:"Could not parse cache key."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."}},y=(e(E,a=r),E.createClientInfoDecodingError=function(e){return new E(u.clientInfoDecodingError.code,u.clientInfoDecodingError.desc+" Failed with error: "+e)},E.createClientInfoEmptyError=function(e){return new E(u.clientInfoEmptyError.code,u.clientInfoEmptyError.desc+" Given Object: "+e)},E.createIdTokenParsingError=function(e){return new E(u.idTokenParsingError.code,u.idTokenParsingError.desc+" Failed with error: "+e)},E.createIdTokenNullOrEmptyError=function(e){return new E(u.nullOrEmptyIdToken.code,u.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},E.createEndpointDiscoveryIncompleteError=function(e){return new E(u.endpointResolutionError.code,u.endpointResolutionError.desc+" Detail: "+e)},E.createInvalidAuthorityTypeError=function(e){return new E(u.invalidAuthorityType.code,u.invalidAuthorityType.desc+" Given Url: "+e)},E.createHashNotDeserializedError=function(e){return new E(u.hashNotDeserialized.code,u.hashNotDeserialized.desc+" Given Object: "+e)},E.createInvalidStateError=function(e,t){return new E(u.invalidStateError.code,u.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+t)},E.createStateMismatchError=function(){return new E(u.stateMismatchError.code,u.stateMismatchError.desc)},E.createNonceMismatchError=function(){return new E(u.nonceMismatchError.code,u.nonceMismatchError.desc)},E.createAccountMismatchError=function(){return new E(u.accountMismatchError.code,u.accountMismatchError.desc)},E.createInvalidIdTokenError=function(e){return new E(u.invalidIdToken.code,u.invalidIdToken.desc+" Given token: "+JSON.stringify(e))},E.createNoTokensFoundError=function(){return new E(u.noTokensFoundError.code,u.noTokensFoundError.desc)},E.createCacheParseError=function(e){return new E(u.cacheParseError.code,u.cacheParseError.desc+" Cache key: "+e)},E.createUserLoginRequiredError=function(){return new E(u.userLoginRequiredError.code,u.userLoginRequiredError.desc)},E.createMultipleMatchingTokensInCacheError=function(e){return new E(u.multipleMatchingTokens.code,"Cache error for scope "+e+": "+u.multipleMatchingTokens.desc+".")},E.createMultipleMatchingAccountsInCacheError=function(){return new E(u.multipleMatchingAccounts.code,u.multipleMatchingAccounts.desc)},E.createTokenRequestCannotBeMadeError=function(){return new E(u.tokenRequestCannotBeMade.code,u.tokenRequestCannotBeMade.desc)},E.createAppendEmptyScopeToSetError=function(e){return new E(u.appendEmptyScopeError.code,u.appendEmptyScopeError.desc+" Given Scope: "+e)},E.createRemoveEmptyScopeFromSetError=function(e){return new E(u.removeEmptyScopeError.code,u.removeEmptyScopeError.desc+" Given Scope: "+e)},E.createAppendScopeSetError=function(e){return new E(u.appendScopeSetError.code,u.appendScopeSetError.desc+" Detail Error: "+e)},E.createEmptyInputScopeSetError=function(e){return new E(u.emptyInputScopeSetError.code,u.emptyInputScopeSetError.desc+" Given ScopeSet: "+e)},E.createDeviceCodeCancelledError=function(){return new E(u.DeviceCodePollingCancelled.code,""+u.DeviceCodePollingCancelled.desc)},E.createDeviceCodeExpiredError=function(){return new E(u.DeviceCodeExpired.code,""+u.DeviceCodeExpired.desc)},E.createNoAccountInSilentRequestError=function(){return new E(u.NoAccountInSilentRequest.code,""+u.NoAccountInSilentRequest.desc)},E.createNullOrUndefinedCacheRecord=function(){return new E(u.invalidCacheRecord.code,u.invalidCacheRecord.desc)},E.createInvalidCacheEnvironmentError=function(){return new E(u.invalidCacheEnvironment.code,u.invalidCacheEnvironment.desc)},E.createNoAccountFoundError=function(){return new E(u.noAccountFound.code,u.noAccountFound.desc)},E.createCachePluginError=function(){return new E(u.CachePluginError.code,""+u.CachePluginError.desc)},E.createNoCryptoObjectError=function(e){return new E(u.noCryptoObj.code,""+u.noCryptoObj.desc+e)},E.createInvalidCacheTypeError=function(){return new E(u.invalidCacheType.code,""+u.invalidCacheType.desc)},E.createUnexpectedAccountTypeError=function(){return new E(u.unexpectedAccountType.code,""+u.unexpectedAccountType.desc)},E.createUnexpectedCredentialTypeError=function(){return new E(u.unexpectedCredentialType.code,""+u.unexpectedCredentialType.desc)},E);function E(e,t){var r=a.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,E.prototype),r}var m,C=(g.decodeJwt=function(e){if(g.isEmpty(e))throw y.createIdTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw y.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},g.isEmpty=function(e){return void 0===e||!e||0===e.length},g.queryStringToObject=function(e){function t(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},g.trimAndConvertArrayEntriesToLowerCase=function(e){return e.map(function(e){return e.trim().toLowerCase()})},g.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!g.isEmpty(e)})},g);function g(){}(m=l.LogLevel||(l.LogLevel={}))[m.Error=0]="Error",m[m.Warning=1]="Warning",m[m.Info=2]="Info",m[m.Verbose=3]="Verbose";var v=(T.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(C.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+d+" : "+l.LogLevel[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii)}},T.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},T.prototype.error=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Error,containsPii:!1,correlationId:t||""})},T.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Error,containsPii:!0,correlationId:t||""})},T.prototype.warning=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Warning,containsPii:!1,correlationId:t||""})},T.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Warning,containsPii:!0,correlationId:t||""})},T.prototype.info=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Info,containsPii:!1,correlationId:t||""})},T.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Info,containsPii:!0,correlationId:t||""})},T.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Verbose,containsPii:!1,correlationId:t||""})},T.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:l.LogLevel.Verbose,containsPii:!0,correlationId:t||""})},T.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},T);function T(e){this.level=l.LogLevel.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}var _,I,S,A,R,O,w,N,k={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined"};(_||(_={})).CONTENT_TYPE="Content-Type",(I=l.PersistentCacheKeys||(l.PersistentCacheKeys={})).ID_TOKEN="idtoken",I.CLIENT_INFO="client.info",I.ADAL_ID_TOKEN="adal.idtoken",I.ERROR="error",I.ERROR_DESC="error.description",(A=S=S||{}).COMMON="common",A.ORGANIZATIONS="organizations",A.CONSUMERS="consumers",(O=R=R||{}).CLIENT_ID="client_id",O.REDIRECT_URI="redirect_uri",O.RESPONSE_TYPE="response_type",O.RESPONSE_MODE="response_mode",O.GRANT_TYPE="grant_type",O.CLAIMS="claims",O.SCOPE="scope",O.ERROR="error",O.ERROR_DESCRIPTION="error_description",O.ACCESS_TOKEN="access_token",O.ID_TOKEN="id_token",O.REFRESH_TOKEN="refresh_token",O.EXPIRES_IN="expires_in",O.STATE="state",O.NONCE="nonce",O.PROMPT="prompt",O.SESSION_STATE="session_state",O.CLIENT_INFO="client_info",O.CODE="code",O.CODE_CHALLENGE="code_challenge",O.CODE_CHALLENGE_METHOD="code_challenge_method",O.CODE_VERIFIER="code_verifier",O.CLIENT_REQUEST_ID="client-request-id",O.X_CLIENT_SKU="x-client-SKU",O.X_CLIENT_VER="x-client-VER",O.X_CLIENT_OS="x-client-OS",O.X_CLIENT_CPU="x-client-CPU",O.POST_LOGOUT_URI="post_logout_redirect_uri",O.DEVICE_CODE="device_code",(N=w=w||{}).ISSUER="iss",N.OBJID="oid",N.SUBJECT="sub",N.TENANTID="tid",N.VERSION="ver",N.PREF_USERNAME="preferred_username",N.NAME="name",N.NONCE="nonce",N.EXPIRATION="exp",N.HOME_OBJID="home_oid",N.SESSIONID="sid",N.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name";var P,D,b={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(D=P=P||{}).ACCOUNT="account",D.SID="sid",D.LOGIN_HINT="login_hint",D.ID_TOKEN="id_token",D.DOMAIN_HINT="domain_hint",D.ORGANIZATIONS="organizations",D.CONSUMERS="consumers",D.ACCOUNT_ID="accountIdentifier",D.HOMEACCOUNT_ID="homeAccountIdentifier";P.SID,P.LOGIN_HINT;var U,L,M,x,q,F,H,K,G,j,z,Y={PLAIN:"plain",S256:"S256"};(U=l.ResponseMode||(l.ResponseMode={})).QUERY="query",U.FRAGMENT="fragment",U.FORM_POST="form_post",(M=L=L||{}).IMPLICIT_GRANT="implicit",M.AUTHORIZATION_CODE_GRANT="authorization_code",M.CLIENT_CREDENTIALS_GRANT="client_credentials",M.RESOURCE_OWNER_PASSWORD_GRANT="password",M.REFRESH_TOKEN_GRANT="refresh_token",M.DEVICE_CODE_GRANT="device_code",(q=x=x||{}).MSSTS_ACCOUNT_TYPE="MSSTS",q.ADFS_ACCOUNT_TYPE="ADFS",q.MSAV1_ACCOUNT_TYPE="MSA",q.GENERIC_ACCOUNT_TYPE="Generic",(H=F=F||{}).CACHE_KEY_SEPARATOR="-",H.CLIENT_INFO_SEPARATOR=".",(K=l.CredentialType||(l.CredentialType={})).ID_TOKEN="IdToken",K.ACCESS_TOKEN="AccessToken",K.REFRESH_TOKEN="RefreshToken",(G=l.CacheSchemaType||(l.CacheSchemaType={})).ACCOUNT="Account",G.CREDENTIAL="Credential",G.APP_META_DATA="AppMetadata",G.TEMPORARY="TempCache",(z=j=j||{})[z.ADFS=1001]="ADFS",z[z.MSA=1002]="MSA",z[z.MSSTS=1003]="MSSTS",z[z.GENERIC=1004]="GENERIC",z[z.ACCESS_TOKEN=2001]="ACCESS_TOKEN",z[z.REFRESH_TOKEN=2002]="REFRESH_TOKEN",z[z.ID_TOKEN=2003]="ID_TOKEN",z[z.APP_META_DATA=3001]="APP_META_DATA";var V="appmetadata",B=(Q.prototype.generateAccountId=function(){return Q.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},Q.prototype.generateCredentialId=function(){return Q.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},Q.prototype.generateTarget=function(){return Q.generateTargetForCacheKey(this.target)},Q.prototype.generateCredentialKey=function(){return Q.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},Q.prototype.generateType=function(){switch(this.credentialType){case l.CredentialType.ID_TOKEN:return j.ID_TOKEN;case l.CredentialType.ACCESS_TOKEN:return j.ACCESS_TOKEN;case l.CredentialType.REFRESH_TOKEN:return j.REFRESH_TOKEN;default:throw y.createUnexpectedCredentialTypeError()}},Q.getCredentialType=function(e){return-1!==e.indexOf(l.CredentialType.ACCESS_TOKEN.toLowerCase())?l.CredentialType.ACCESS_TOKEN:-1!==e.indexOf(l.CredentialType.ID_TOKEN.toLowerCase())?l.CredentialType.ID_TOKEN:-1!==e.indexOf(l.CredentialType.REFRESH_TOKEN.toLowerCase())?l.CredentialType.REFRESH_TOKEN:k.NOT_DEFINED},Q.generateCredentialCacheKey=function(e,t,r,n,o,i,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,c),this.generateTargetForCacheKey(i)].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},Q.generateAccountIdForCacheKey=function(e,t){return[e,t].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},Q.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===l.CredentialType.REFRESH_TOKEN&&n||t,r||""].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},Q.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},Q);function Q(){}var J,X={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},knownAuthoritiesAndCloudDiscoveryMetadata:{code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."}},W=(e(Z,J=y),Z.createRedirectUriEmptyError=function(){return new Z(X.redirectUriNotSet.code,X.redirectUriNotSet.desc)},Z.createPostLogoutRedirectUriEmptyError=function(){return new Z(X.postLogoutUriNotSet.code,X.postLogoutUriNotSet.desc)},Z.createClaimsRequestParsingError=function(e){return new Z(X.claimsRequestParsingError.code,X.claimsRequestParsingError.desc+" Given value: "+e)},Z.createInsecureAuthorityUriError=function(e){return new Z(X.authorityUriInsecure.code,X.authorityUriInsecure.desc+" Given URI: "+e)},Z.createUrlParseError=function(e){return new Z(X.urlParseError.code,X.urlParseError.desc+" Given Error: "+e)},Z.createUrlEmptyError=function(){return new Z(X.urlEmptyError.code,X.urlEmptyError.desc)},Z.createScopesNonArrayError=function(e){return new Z(X.nonArrayScopesError.code,X.nonArrayScopesError.desc+" Given Scopes: "+e)},Z.createEmptyScopesArrayError=function(e){return new Z(X.emptyScopesError.code,X.emptyScopesError.desc+" Given Scopes: "+e)},Z.createClientIdSingleScopeError=function(e){return new Z(X.clientIdSingleScopeError.code,X.clientIdSingleScopeError.desc+" Given Scopes: "+e)},Z.createInvalidPromptError=function(e){return new Z(X.invalidPrompt.code,X.invalidPrompt.desc+" Given value: "+e)},Z.createEmptyLogoutRequestError=function(){return new Z(X.logoutRequestEmptyError.code,X.logoutRequestEmptyError.desc)},Z.createEmptyTokenRequestError=function(){return new Z(X.tokenRequestEmptyError.code,X.tokenRequestEmptyError.desc)},Z.createInvalidCodeChallengeMethodError=function(){return new Z(X.invalidCodeChallengeMethod.code,X.invalidCodeChallengeMethod.desc)},Z.createInvalidCodeChallengeParamsError=function(){return new Z(X.invalidCodeChallengeParams.code,X.invalidCodeChallengeParams.desc)},Z.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new Z(X.knownAuthoritiesAndCloudDiscoveryMetadata.code,X.knownAuthoritiesAndCloudDiscoveryMetadata.desc)},Z.createInvalidCloudDiscoveryMetadataError=function(){return new Z(X.invalidCloudDiscoveryMetadata.code,X.invalidCloudDiscoveryMetadata.desc)},Z.createUntrustedAuthorityError=function(){return new Z(X.untrustedAuthority.code,X.untrustedAuthority.desc)},Z);function Z(e,t){var r=J.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,Z.prototype),r}var $=(ee.fromString=function(e){return new ee((e=e||"").split(" "))},ee.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw W.createEmptyScopesArrayError(e)},ee.prototype.containsScope=function(e){return!C.isEmpty(e)&&this.scopes.has(e)},ee.prototype.containsScopeSet=function(e){var t=this;return!!e&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},ee.prototype.appendScope=function(e){C.isEmpty(e)||this.scopes.add(e.trim().toLowerCase())},ee.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw y.createAppendScopeSetError(e)}},ee.prototype.removeScope=function(e){if(C.isEmpty(e))throw y.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim().toLowerCase())},ee.prototype.unionScopeSets=function(e){if(!e)throw y.createEmptyInputScopeSetError(e);return new Set(o(e.asArray(),Array.from(this.scopes)))},ee.prototype.intersectingScopeSets=function(e){if(!e)throw y.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},ee.prototype.getScopeCount=function(){return this.scopes.size},ee.prototype.asArray=function(){return Array.from(this.scopes)},ee.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},ee);function ee(e){var t=e?C.trimAndConvertArrayEntriesToLowerCase(o(e)):[],r=t?C.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set(r)}function te(e,t){if(C.isEmpty(e))throw y.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw y.createClientInfoDecodingError(e)}}var re=(ne.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(0<e.length&&!C.isEmpty(t))throw W.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var r=JSON.parse(t);this.saveCloudDiscoveryMetadata(r.metadata)}}catch(e){throw W.createInvalidCloudDiscoveryMetadataError()}}},ne.setTrustedAuthoritiesFromNetwork=function(i,c){return p(this,void 0,void 0,function(){var t,r,n,o;return f(this,function(e){switch(e.label){case 0:t=""+k.AAD_INSTANCE_DISCOVERY_ENDPT+i.urlString+"oauth2/v2.0/authorize",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.sendGetRequestAsync(t)];case 2:return r=e.sent(),n=r.body.metadata,this.saveCloudDiscoveryMetadata(n),[3,4];case 3:return e.sent(),[2];case 4:return o=i.getUrlComponents().HostNameAndPort,0<this.getTrustedHostList().length&&!this.IsInTrustedHostList(o)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([o]),[2]}})})},ne.saveCloudDiscoveryMetadata=function(e){e.forEach(function(t){t.aliases.forEach(function(e){ne.TrustedHostList[e.toLowerCase()]=t})})},ne.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var t=this;e.forEach(function(e){t.TrustedHostList[e.toLowerCase()]={preferred_cache:e.toLowerCase(),preferred_network:e.toLowerCase(),aliases:[e.toLowerCase()]}})},ne.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},ne.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},ne.IsInTrustedHostList=function(e){return-1<Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())},ne.TrustedHostList={},ne);function ne(){}var oe=(ie.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},ie.prototype.generateAccountKey=function(){return ie.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},ie.prototype.generateType=function(){switch(this.authorityType){case x.ADFS_ACCOUNT_TYPE:return j.ADFS;case x.MSAV1_ACCOUNT_TYPE:return j.MSA;case x.MSSTS_ACCOUNT_TYPE:return j.MSSTS;case x.GENERIC_ACCOUNT_TYPE:return j.GENERIC;default:throw y.createUnexpectedAccountTypeError()}},ie.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username}},ie.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},ie.createAccount=function(e,t,r,n){var o=new ie;o.authorityType=x.MSSTS_ACCOUNT_TYPE;var i=te(o.clientInfo=e,n);o.homeAccountId=""+i.uid+F.CLIENT_INFO_SEPARATOR+i.utid;var c=t.canonicalAuthorityUrlComponents.HostNameAndPort,a=re.getCloudDiscoveryMetadata(c)?re.getCloudDiscoveryMetadata(c).preferred_cache:"";if(C.isEmpty(a))throw y.createInvalidCacheEnvironmentError();if(o.environment=a,o.realm=r.claims.tid,r){var s=C.isEmpty(r.claims.oid)?r.claims.sid:r.claims.oid;o.localAccountId=s,o.username=r.claims.preferred_username,o.name=r.claims.name}return o},ie.createADFSAccount=function(e,t){var r=new ie;r.authorityType=x.ADFS_ACCOUNT_TYPE,r.homeAccountId=t.claims.sub;var n=e.canonicalAuthorityUrlComponents.HostNameAndPort,o=re.getCloudDiscoveryMetadata(n)?re.getCloudDiscoveryMetadata(n).preferred_cache:"";if(C.isEmpty(o))throw y.createInvalidCacheEnvironmentError();return r.environment=o,r.username=t.claims.upn,r},ie);function ie(){}var ce=(ae.prototype.getAllAccounts=function(){var e=this.getAccountsFilteredBy(),t=Object.values(e);return t.length<1?null:t.map(function(e){var t=new oe;return(t=ae.toObject(t,e)).getAccountInfo()})},ae.prototype.saveCacheRecord=function(e){if(!e)throw y.createNullOrUndefinedCacheRecord();e.account&&this.saveAccount(e.account),e.idToken&&this.saveCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.saveCredential(e.refreshToken)},ae.prototype.saveAccount=function(e){var t=e.generateAccountKey();this.setItem(t,e,l.CacheSchemaType.ACCOUNT)},ae.prototype.saveCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,e,l.CacheSchemaType.CREDENTIAL)},ae.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:l.CredentialType.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=$.fromString(e.target),o=Object.values(r.accessTokens);o&&o.forEach(function(e){$.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)}),this.saveCredential(e)},ae.prototype.getAccount=function(e){return this.getItem(e,l.CacheSchemaType.ACCOUNT)},ae.prototype.getCredential=function(e){return this.getItem(e,l.CacheSchemaType.CREDENTIAL)},ae.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},ae.prototype.getAccountsFilteredByInternal=function(r,n,o){var i,c=this,e=this.getKeys(),a={};return e.forEach(function(e){var t=!0;if(B.getCredentialType(e)===k.NOT_DEFINED&&!c.isAppMetadata(e)){try{i=c.getItem(e,l.CacheSchemaType.ACCOUNT)}catch(e){return}C.isEmpty(r)||(t=c.matchHomeAccountId(i,r)),C.isEmpty(n)||(t=t&&c.matchEnvironment(i,n)),C.isEmpty(o)||(t=t&&c.matchRealm(i,o)),t&&(a[e]=i)}}),a},ae.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.realm,e.target)},ae.prototype.getCredentialsFilteredByInternal=function(o,i,c,a,s,d){var u=this,e=this.getKeys(),p={idTokens:{},accessTokens:{},refreshTokens:{}};return e.forEach(function(e){var t,r=!0,n=B.getCredentialType(e);if(n!==k.NOT_DEFINED){try{t=u.getItem(e,l.CacheSchemaType.CREDENTIAL)}catch(e){return}if(C.isEmpty(o)||(r=u.matchHomeAccountId(t,o)),C.isEmpty(i)||(r=r&&u.matchEnvironment(t,i)),C.isEmpty(s)||(r=r&&u.matchRealm(t,s)),C.isEmpty(c)||(r=r&&u.matchCredentialType(t,c)),C.isEmpty(a)||(r=r&&u.matchClientId(t,a)),C.isEmpty(d)||n!==l.CredentialType.ACCESS_TOKEN||(r=r&&u.matchTarget(t,d)),r)switch(n){case l.CredentialType.ID_TOKEN:p.idTokens[e]=t;break;case l.CredentialType.ACCESS_TOKEN:p.accessTokens[e]=t;break;case l.CredentialType.REFRESH_TOKEN:p.refreshTokens[e]=t}}}),p},ae.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw y.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,l.CacheSchemaType.ACCOUNT)},ae.prototype.removeAccountContext=function(e){var r=this,t=this.getKeys(),n=e.generateAccountId();return t.forEach(function(e){if(B.getCredentialType(e)!==k.NOT_DEFINED){var t=r.getItem(e,l.CacheSchemaType.CREDENTIAL);t&&n===t.generateAccountId()&&r.removeCredential(t)}}),!0},ae.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,l.CacheSchemaType.CREDENTIAL)},ae.prototype.matchHomeAccountId=function(e,t){return t===e.homeAccountId},ae.prototype.matchEnvironment=function(e,t){var r=re.getCloudDiscoveryMetadata(t);return!!(r&&-1<r.aliases.indexOf(e.environment))},ae.prototype.matchCredentialType=function(e,t){return t.toLowerCase()===e.credentialType.toLowerCase()},ae.prototype.matchClientId=function(e,t){return t===e.clientId},ae.prototype.matchRealm=function(e,t){return t===e.realm},ae.prototype.matchTarget=function(e,t){var r=$.fromString(e.target),n=$.fromString(t);return r.containsScopeSet(n)},ae.prototype.isAppMetadata=function(e){return-1!==e.indexOf(V)},ae.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},ae);function ae(){}var se,de=(e(ue,se=ce),ue.prototype.setItem=function(){throw r.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},ue.prototype.getItem=function(){throw r.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},ue.prototype.removeItem=function(){throw r.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},ue.prototype.containsKey=function(){throw r.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},ue.prototype.getKeys=function(){throw r.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},ue.prototype.clear=function(){throw r.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},ue);function ue(){return null!==se&&se.apply(this,arguments)||this}var pe={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:""},le={tokenRenewalOffsetSeconds:300,telemetry:null},he={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:l.LogLevel.Info},fe={sendGetRequestAsync:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw r.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw r.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},ye={createNewGuid:function(){throw r.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw r.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw r.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw r.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})}},Ee={sku:k.SKU,version:s,cpu:"",os:""};var me=(Ce.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e.set(_.CONTENT_TYPE,k.URL_FORM_CONTENT_TYPE),e},Ce.prototype.createDefaultLibraryHeaders=function(){var e=new Map;return e.set(""+R.X_CLIENT_SKU,this.config.libraryInfo.sku),e.set(""+R.X_CLIENT_VER,this.config.libraryInfo.version),e.set(""+R.X_CLIENT_OS,this.config.libraryInfo.os),e.set(""+R.X_CLIENT_CPU,this.config.libraryInfo.cpu),e},Ce.prototype.executePostToTokenEndpoint=function(e,t,r){return this.networkClient.sendPostRequestAsync(e,{body:t,headers:r})},Ce);function Ce(e){var t,r,n,o,i,c,a,s;this.config=(r=(t=e).authOptions,n=t.systemOptions,o=t.loggerOptions,i=t.storageInterface,c=t.networkInterface,a=t.cryptoInterface,s=t.libraryInfo,{authOptions:h(h({},pe),r),systemOptions:h(h({},le),n),loggerOptions:h(h({},he),o),storageInterface:i||new de,networkInterface:c||fe,cryptoInterface:a||ye,libraryInfo:h(h({},Ee),s)}),this.logger=new v(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,re.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}var ge=(ve.validateRedirectUri=function(e){if(C.isEmpty(e))throw W.createRedirectUriEmptyError()},ve.validatePrompt=function(e){if([b.LOGIN,b.SELECT_ACCOUNT,b.CONSENT,b.NONE].indexOf(e)<0)throw W.createInvalidPromptError(e)},ve.validateCodeChallengeParams=function(e,t){if(C.isEmpty(e)||C.isEmpty(t))throw W.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},ve.validateCodeChallengeMethod=function(e){if([Y.PLAIN,Y.S256].indexOf(e)<0)throw W.createInvalidCodeChallengeMethodError()},ve.sanitizeEQParams=function(r,e){return r?(e.forEach(function(e,t){r[t]&&delete r[t]}),r):null},ve);function ve(){}var Te=(_e.prototype.addResponseTypeCode=function(){this.parameters.set(R.RESPONSE_TYPE,encodeURIComponent(k.CODE_RESPONSE_TYPE))},_e.prototype.addResponseMode=function(e){this.parameters.set(R.RESPONSE_MODE,encodeURIComponent(e||l.ResponseMode.QUERY))},_e.prototype.addScopes=function(e){this.parameters.set(R.SCOPE,encodeURIComponent(e.printScopes()))},_e.prototype.addClientId=function(e){this.parameters.set(R.CLIENT_ID,encodeURIComponent(e))},_e.prototype.addRedirectUri=function(e){ge.validateRedirectUri(e),this.parameters.set(R.REDIRECT_URI,encodeURIComponent(e))},_e.prototype.addDomainHint=function(e){this.parameters.set(P.DOMAIN_HINT,encodeURIComponent(e))},_e.prototype.addLoginHint=function(e){this.parameters.set(P.LOGIN_HINT,encodeURIComponent(e))},_e.prototype.addClaims=function(e){this.parameters.set(R.CLAIMS,encodeURIComponent(e))},_e.prototype.addCorrelationId=function(e){this.parameters.set(R.CLIENT_REQUEST_ID,encodeURIComponent(e))},_e.prototype.addLibraryInfo=function(e){this.parameters.set(R.X_CLIENT_SKU,e.sku),this.parameters.set(R.X_CLIENT_VER,e.version),this.parameters.set(R.X_CLIENT_OS,e.os),this.parameters.set(R.X_CLIENT_CPU,e.cpu)},_e.prototype.addPrompt=function(e){ge.validatePrompt(e),this.parameters.set(""+R.PROMPT,encodeURIComponent(e))},_e.prototype.addState=function(e){C.isEmpty(e)||this.parameters.set(R.STATE,encodeURIComponent(e))},_e.prototype.addNonce=function(e){this.parameters.set(R.NONCE,encodeURIComponent(e))},_e.prototype.addCodeChallengeParams=function(e,t){if(ge.validateCodeChallengeParams(e,t),!e||!t)throw W.createInvalidCodeChallengeParamsError();this.parameters.set(R.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(R.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},_e.prototype.addAuthorizationCode=function(e){this.parameters.set(R.CODE,encodeURIComponent(e))},_e.prototype.addDeviceCode=function(e){this.parameters.set(R.DEVICE_CODE,encodeURIComponent(e))},_e.prototype.addRefreshToken=function(e){this.parameters.set(R.REFRESH_TOKEN,encodeURIComponent(e))},_e.prototype.addCodeVerifier=function(e){this.parameters.set(R.CODE_VERIFIER,encodeURIComponent(e))},_e.prototype.addGrantType=function(e){this.parameters.set(R.GRANT_TYPE,encodeURIComponent(e))},_e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},_e.prototype.addExtraQueryParameters=function(t){var r=this;ge.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(e){r.parameters.set(e,t[e])})},_e.prototype.createQueryString=function(){var r=new Array;return this.parameters.forEach(function(e,t){r.push(t+"="+e)}),r.join("&")},_e);function _e(){this.parameters=new Map}var Ie,Se=(e(Ae,Ie=r),Ae);function Ae(e,t,r){var n=Ie.call(this,e,t)||this;return n.name="ServerError",n.subError=r,Object.setPrototypeOf(n,Ae.prototype),n}var Re=(Oe.extractIdToken=function(e,t){var r=C.decodeJwt(e);if(!r)return null;try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw y.createIdTokenParsingError(e)}},Oe);function Oe(e,t){if(C.isEmpty(e))throw y.createIdTokenNullOrEmptyError(e);this.rawIdToken=e,this.claims=Oe.extractIdToken(e,t)}var we,Ne=(ke.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},ke);function ke(){}(we=l.AuthorityType||(l.AuthorityType={}))[we.Default=0]="Default",we[we.Adfs=1]="Adfs";var Pe,De=(e(be,Pe=B),be.createIdTokenEntity=function(e,t,r,n,o){var i=new be;return i.credentialType=l.CredentialType.ID_TOKEN,i.homeAccountId=e,i.environment=t,i.clientId=n,i.secret=r,i.realm=o,i},be);function be(){return null!==Pe&&Pe.apply(this,arguments)||this}var Ue,Le=(e(Me,Ue=B),Me.createAccessTokenEntity=function(e,t,r,n,o,i,c,a){var s=new Me;s.homeAccountId=e,s.credentialType=l.CredentialType.ACCESS_TOKEN,s.secret=r;var d=Ne.nowSeconds();return s.cachedAt=d.toString(),s.expiresOn=c.toString(),s.extendedExpiresOn=a.toString(),s.environment=t,s.clientId=n,s.realm=o,s.target=i,s},Me);function Me(){return null!==Ue&&Ue.apply(this,arguments)||this}var xe,qe=(e(Fe,xe=B),Fe.createRefreshTokenEntity=function(e,t,r,n,o){var i=new Fe;return i.clientId=n,i.credentialType=l.CredentialType.REFRESH_TOKEN,i.environment=t,i.homeAccountId=e,i.secret=r,o&&(i.familyId=o),i},Fe);function Fe(){return null!==xe&&xe.apply(this,arguments)||this}var He,Ke=["interaction_required","consent_required","login_required"],Ge=["message_only","additional_action","basic_action","user_password_expired","consent_required"],je=(e(ze,He=Se),ze.isInteractionRequiredError=function(e,t,r){var n=!C.isEmpty(e)&&-1<Ke.indexOf(e),o=!C.isEmpty(r)&&-1<Ge.indexOf(r),i=!C.isEmpty(t)&&Ke.some(function(e){return-1<t.indexOf(e)});return n||i||o},ze);function ze(e,t,r){var n=He.call(this,e,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,ze.prototype),n}var Ye=function(e,t,r,n){this.account=e,this.idToken=t,this.accessToken=r,this.refreshToken=n},Ve=(Be.setRequestState=function(e,t){var r=Be.generateLibraryState(t);return C.isEmpty(e)?r:""+r+k.RESOURCE_DELIM+e},Be.generateLibraryState=function(e){if(!e)throw y.createNoCryptoObjectError("generateLibraryState");var t={id:e.createNewGuid(),ts:Ne.nowSeconds()},r=JSON.stringify(t);return e.base64Encode(r)},Be.parseRequestState=function(t,e){if(!e)throw y.createNoCryptoObjectError("parseRequestState");if(C.isEmpty(t))throw y.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(k.RESOURCE_DELIM),n=r[0],o=1<r.length?r.slice(1).join(k.RESOURCE_DELIM):"",i=e.base64Decode(n),c=JSON.parse(i);return{userRequestState:C.isEmpty(o)?"":o,libraryState:c}}catch(e){throw y.createInvalidStateError(t,e)}},Be);function Be(){}var Qe=(Je.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(e.state!==t)throw y.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(je.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new je(e.error,e.error_description,e.suberror);throw new Se(e.error,e.error_description,e.suberror)}e.client_info&&te(e.client_info,r)},Je.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(je.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new je(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Se(e.error,t)}e.client_info&&(this.clientInfo=te(e.client_info,this.cryptoObj),C.isEmpty(this.clientInfo.uid)||C.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid))},Je.prototype.handleServerTokenResponse=function(e,t,r,n){var o=new Re(e.id_token,this.cryptoObj);if(!C.isEmpty(r)&&o.claims.nonce!==r)throw y.createNonceMismatchError();var i=null;C.isEmpty(n)||(i=Ve.parseRequestState(n,this.cryptoObj));var c=this.generateCacheRecord(e,o,t,i&&i.libraryState);return this.cacheStorage.saveCacheRecord(c),Je.generateAuthenticationResult(c,o,!1,i?i.userRequestState:null)},Je.prototype.generateCacheRecord=function(e,t,r,n){var o=this.generateAccountEntity(e,t,r),i=r.canonicalAuthorityUrlComponents.HostNameAndPort,c=re.getCloudDiscoveryMetadata(i)?re.getCloudDiscoveryMetadata(i).preferred_cache:"";if(C.isEmpty(c))throw y.createInvalidCacheEnvironmentError();var a=De.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token,this.clientId,t.claims.tid),s=$.fromString(e.scope),d=Ne.nowSeconds(),u=(n?n.ts:d)+e.expires_in,p=u+e.ext_expires_in,l=Le.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token,this.clientId,t.claims.tid,s.printScopes(),u,p),h=qe.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci);return new Ye(o,a,l,h)},Je.prototype.generateAccountEntity=function(e,t,r){var n=r.authorityType;if(C.isEmpty(e.client_info))throw y.createClientInfoEmptyError(e.client_info);return n===l.AuthorityType.Adfs?oe.createADFSAccount(r,t):oe.createAccount(e.client_info,r,t,this.cryptoObj)},Je.generateAuthenticationResult=function(e,t,r,n){var o=$.fromString(e.accessToken.target);return{uniqueId:t.claims.oid||t.claims.sub,tenantId:t.claims.tid,scopes:o.asArray(),account:e.account.getAccountInfo(),idToken:t.rawIdToken,idTokenClaims:t.claims,accessToken:e.accessToken.secret,fromCache:r,expiresOn:new Date(1e3*Number(e.accessToken.expiresOn)),extExpiresOn:new Date(1e3*Number(e.accessToken.extendedExpiresOn)),familyId:e.refreshToken.familyId||null,state:n||""}},Je);function Je(e,t,r,n){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n}var Xe=(Object.defineProperty(We.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),We.prototype.canonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!e.endsWith("/")&&(e+="/"),e},We.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw W.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw W.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw W.createInsecureAuthorityUriError(this.urlString)},We.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},We.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==S.COMMON&&r[0]!==S.ORGANIZATIONS||(r[0]=e),We.constructAuthorityUriFromObject(t)},We.prototype.getHash=function(){var e=this.urlString.indexOf("#"),t=this.urlString.indexOf("#/");return-1<t?this.urlString.substring(t+2):-1<e?this.urlString.substring(e+1):""},We.prototype.getDeserializedHash=function(){var e=this.getHash(),t=C.queryStringToObject(e);if(!t)throw y.createHashNotDeserializedError(JSON.stringify(t));return t},We.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw W.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},n=r.AbsolutePath.split("/");return n=n.filter(function(e){return e&&0<e.length}),r.PathSegments=n,r},We.constructAuthorityUriFromObject=function(e){return new We(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},We.hashContainsKnownProperties=function(e){if(C.isEmpty(e))return!1;var t=new We(e).getDeserializedHash();return!!(t.code||t.error_description||t.error||t.state)},We);function We(e){if(this._urlString=e,!C.isEmpty(this._urlString)&&C.isEmpty(this.getHash()))this._urlString=this.canonicalizeUri(e);else if(C.isEmpty(this._urlString))throw W.createUrlEmptyError()}var Ze,$e=(e(et,Ze=me),et.prototype.getAuthCodeUrl=function(r){return p(this,void 0,void 0,function(){var t;return f(this,function(e){return t=this.createAuthCodeUrlQueryString(r),[2,this.authority.authorizationEndpoint+"?"+t]})})},et.prototype.acquireToken=function(n,o,i){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:if(this.logger.info("in acquireToken call"),!n||C.isEmpty(n.code))throw y.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new Qe(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority,o,i)]}})})},et.prototype.handleFragmentResponse=function(e,t){var r=new Qe(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),n=new Xe(e).getDeserializedHash();return r.validateServerAuthorizationCodeResponse(n,t,this.cryptoUtils),n.code},et.prototype.getLogoutUri=function(e){if(!e)throw W.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(oe.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=e.postLogoutRedirectUri?"?"+R.POST_LOGOUT_URI+"="+encodeURIComponent(e.postLogoutRedirectUri):"",r=e.correlationId?"&"+R.CLIENT_REQUEST_ID+"="+encodeURIComponent(e.correlationId):"";return this.authority.endSessionEndpoint+t+r},et.prototype.executeTokenRequest=function(n,o){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){return t=this.createTokenRequestBody(o),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(n.tokenEndpoint,t,r)]})})},et.prototype.createTokenRequestBody=function(e){var t=new Te;t.addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri);var r=new $(e.scopes||[]);t.addScopes(r),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),t.addGrantType(L.AUTHORIZATION_CODE_GRANT),t.addClientInfo();var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.createQueryString()},et.prototype.createAuthCodeUrlQueryString=function(e){var t=new Te;t.addClientId(this.config.authOptions.clientId);var r=new $(e.scopes||[]);e.extraScopesToConsent&&r.appendScopes(e.extraScopesToConsent),t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.loginHint&&t.addLoginHint(e.loginHint),e.domainHint&&t.addDomainHint(e.domainHint),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),e.claims&&t.addClaims(e.claims),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},et);function et(e){return Ze.call(this,e)||this}var tt,rt=(e(nt,tt=me),nt.prototype.acquireToken=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.getDeviceCode(n)];case 1:return t=e.sent(),n.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(n,t)];case 2:return r=e.sent(),[2,JSON.stringify(r)]}})})},nt.prototype.getDeviceCode=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){return t=this.createQueryString(n),r=this.createDefaultLibraryHeaders(),[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r)]})})},nt.prototype.executePostRequestToDeviceCodeEndpoint=function(s,d,u){return p(this,void 0,void 0,function(){var t,r,n,o,i,c,a;return f(this,function(e){switch(e.label){case 0:return[4,this.networkClient.sendPostRequestAsync(s,{body:d,headers:u})];case 1:return t=e.sent().body,r=t.user_code,n=t.device_code,o=t.verification_uri,i=t.expires_in,c=t.interval,a=t.message,[2,{userCode:r,deviceCode:n,verificationUri:o,expiresIn:i,interval:c,message:a}]}})})},nt.prototype.createQueryString=function(e){var t=new Te,r=new $(e.scopes||[]);return t.addScopes(r),t.addClientId(this.config.authOptions.clientId),t.createQueryString()},nt.prototype.acquireTokenWithDeviceCode=function(d,n){return p(this,void 0,void 0,function(){var c,a,s,t,r=this;return f(this,function(e){return c=this.createTokenRequestBody(d,n),a=this.createDefaultTokenRequestHeaders(),s=Ne.nowSeconds()+n.expiresIn,t=1e3*n.interval,[2,new Promise(function(n,o){var i=setInterval(function(){return p(r,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),d.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(i),o(y.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return Ne.nowSeconds()>s?(this.logger.error("Device code expired. Expiration time of device code was "+s),clearInterval(i),o(y.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,c,a)];case 3:(t=e.sent()).body&&t.body.error==k.AUTHORIZATION_PENDING?this.logger.info(t.body.error_description):(clearInterval(i),n(t.body)),e.label=4;case 4:return[3,6];case 5:return r=e.sent(),clearInterval(i),o(r),[3,6];case 6:return[2]}})})},t)})]})})},nt.prototype.createTokenRequestBody=function(e,t){var r=new Te,n=new $(e.scopes||[]);r.addScopes(n),r.addClientId(this.config.authOptions.clientId),r.addGrantType(L.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var o=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(o),r.createQueryString()},nt);function nt(e){return tt.call(this,e)||this}var ot,it=(e(ct,ot=me),ct.prototype.acquireToken=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.executeTokenRequest(n,this.authority)];case 1:return t=e.sent(),(r=new Qe(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority)]}})})},ct.prototype.executeTokenRequest=function(n,o){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){return t=this.createTokenRequestBody(n),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,t,r)]})})},ct.prototype.createTokenRequestBody=function(e){var t=new Te;t.addClientId(this.config.authOptions.clientId);var r=new $(e.scopes||[]);t.addScopes(r),t.addGrantType(L.REFRESH_TOKEN_GRANT),t.addClientInfo();var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addRefreshToken(e.refreshToken),t.createQueryString()},ct);function ct(e){return ot.call(this,e)||this}var at,st=(e(dt,at=me),dt.prototype.acquireToken=function(l){return p(this,void 0,void 0,function(){var t,r,n,o,i,c,a,s,d,u,p;return f(this,function(e){if(!l)throw W.createEmptyTokenRequestError();if(!l.account)throw y.createNoAccountInSilentRequestError();if(t=new $(l.scopes||[]),r=oe.generateAccountCacheKey(l.account),n=this.cacheManager.getAccount(r),o=n.homeAccountId,i=n.environment,c=this.readAccessTokenFromCache(o,i,t,n.realm),a=this.readRefreshTokenFromCache(o,i),l.forceRefresh||!c||this.isTokenExpired(c.expiresOn)){if(!a)throw y.createNoTokensFoundError();return s=new it(this.config),d=h(h({},l),{refreshToken:a.secret}),[2,s.acquireToken(d)]}return u=this.readIdTokenFromCache(o,i,n.realm),p=new Re(u.secret,this.config.cryptoInterface),[2,Qe.generateAuthenticationResult({account:n,accessToken:c,idToken:u,refreshToken:a},p,!0)]})})},dt.prototype.readIdTokenFromCache=function(e,t,r){var n=B.generateCredentialCacheKey(e,t,l.CredentialType.ID_TOKEN,this.config.authOptions.clientId,r);return this.cacheManager.getCredential(n)},dt.prototype.readAccessTokenFromCache=function(e,t,r,n){var o={homeAccountId:e,environment:t,credentialType:l.CredentialType.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:n,target:r.printScopes()},i=this.cacheManager.getCredentialsFilteredBy(o),c=Object.values(i.accessTokens);return!(1<c.length)&&c.length<1?null:c[0]},dt.prototype.readRefreshTokenFromCache=function(e,t){var r=B.generateCredentialCacheKey(e,t,l.CredentialType.REFRESH_TOKEN,this.config.authOptions.clientId);return this.cacheManager.getCredential(r)},dt.prototype.isTokenExpired=function(e){return(Number(e)||0)<Ne.nowSeconds()+this.config.systemOptions.tokenRenewalOffsetSeconds},dt);function dt(e){return at.call(this,e)||this}var ut=(Object.defineProperty(pt.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===k.ADFS?l.AuthorityType.Adfs:l.AuthorityType.Default},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Xe(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw y.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw y.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw y.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw y.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw y.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),pt.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(pt.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===l.AuthorityType.Adfs?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),pt.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},pt.prototype.discoverEndpoints=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},Object.defineProperty(pt.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+k.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),pt.prototype.validateAndSetPreferredNetwork=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return t=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==re.getTrustedHostList().length?[3,2]:[4,re.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:e.sent(),e.label=2;case 2:if(!re.IsInTrustedHostList(t))throw W.createUntrustedAuthorityError();return r=re.getCloudDiscoveryMetadata(t).preferred_network,t!==r&&(this.canonicalAuthority=this.canonicalAuthority.replace(t,r)),[2]}})})},pt.prototype.resolveEndpointsAsync=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return e.sent(),t=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(t)];case 2:return r=e.sent(),this.tenantDiscoveryResponse=r.body,[2]}})})},pt);function pt(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}var lt=(ht.createDiscoveredInstance=function(n,o){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:if((t=ht.createInstance(n,o)).discoveryComplete())return[2,t];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[2,t];case 3:throw r=e.sent(),y.createEndpointDiscoveryIncompleteError(r);case 4:return[2]}})})},ht.createInstance=function(e,t){if(C.isEmpty(e))throw W.createUrlEmptyError();return new ut(e,t)},ht);function ht(){}var ft=(yt.prototype.generateAppMetaDataEntityKey=function(){return[V,this.environment,this.clientId].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},yt);function yt(){}function Et(){}l.AccessTokenEntity=Le,l.AccountEntity=oe,l.AppMetadataEntity=ft,l.AuthError=r,l.AuthErrorMessage=t,l.AuthenticationResult=Et,l.Authority=ut,l.AuthorityFactory=lt,l.AuthorizationCodeClient=$e,l.CacheManager=ce,l.ClientAuthError=y,l.ClientAuthErrorMessage=u,l.ClientConfigurationError=W,l.ClientConfigurationErrorMessage=X,l.Constants=k,l.CredentialEntity=B,l.DEFAULT_SYSTEM_OPTIONS=le,l.DeviceCodeClient=rt,l.IdToken=Re,l.IdTokenEntity=De,l.InteractionRequiredAuthError=je,l.Logger=v,l.PromptValue=b,l.ProtocolUtils=Ve,l.RefreshTokenClient=it,l.RefreshTokenEntity=qe,l.ServerError=Se,l.SilentFlowClient=st,l.StringUtils=C,l.TimeUtils=Ne,l.TrustedAuthority=re,l.UrlString=Xe,Object.defineProperty(l,"__esModule",{value:!0})});
//# sourceMappingURL=msal-common.min.js.map
